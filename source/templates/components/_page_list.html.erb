<% pages = Dir.glob('pages/*.html.erb') %>
<% pages.sort_by! { |page| page.downcase } %>
<div>
  <nav class="menu">
    <div class="menu-toggle">
      <button class="accordion bg-gray-300 hover:bg-gray-400 py-2 px-4 rounded">Pages</button>
    </div>
    <div class="menu-content hidden">
      <% pages = Dir.glob('source/pages/*.html.erb') %>
      <% pages.sort_by! { |page| page.downcase } %>
      <ul class="menu-items">
        <% pages.each do |page| %>
          <% frontmatter = YAML.load_file(page) %>
          <% permalink = frontmatter['permalink'] || page.sub('.html.erb', '') %>
          <% title = frontmatter['title'] || File.basename(page, '.*').capitalize %>
          <li>
            <a href="<%= url_for(permalink) %>"
              class="block py-2 px-4 text-gray-700 hover:bg-gray-100 transition-colors duration-300 ease-in-out">
              <%= title %>
            </a>
          </li>
        <% end %>
      </ul>
    </div>
  </nav>
</div>

<script>
  // JavaScript to toggle accordion menu
  const menuToggle = document.querySelector('.menu-toggle button');
  const menuContent = document.querySelector('.menu-content');

  menuToggle.addEventListener('click', function () {
    menuContent.classList.toggle('hidden');
  });
</script>

<style>
/* CSS for accordion menu */
.menu-content {
  transition: max-height 0.3s ease-out;
  overflow: hidden;
  max-height: 0;
}

/* CSS for accordion menu */
.menu {
  font-family: '<%= config.font_family %>'; /* Inherit font family from config.yaml */
  color: '<%= config.main_color %>'; /* Inherit color from config.yaml */
  width: fit-content; /* Adjust the width as needed */
  margin-right: 1rem; /* Add margin to separate from other header elements */
}

.menu-toggle {
  background-color: '<%= config.background_color %>'; /* Inherit background color from config.yaml */
  padding: 10px;
}

.menu-toggle button {
  background-color: transparent;
  border: none;
  font-size: 1.2em;
  color: #333;
  cursor: pointer;
}

.menu-content:not(.hidden) {
  max-height: none; /* Remove the fixed height to show all menu items */
  transition: max-height 0.3s ease-in;
}

.menu-items {
  list-style-type: none;
  padding: 0;
  margin: 0;
}

.menu-items li {
  padding: 10px;
}

.menu-items li a {
  display: block;
  padding: 10px;
  color: #333;
  text-decoration: none;
  transition: background-color 0.3s ease-in-out;
}

.menu-items li a:hover {
  background-color: #f5f5f5;
}

</style>

